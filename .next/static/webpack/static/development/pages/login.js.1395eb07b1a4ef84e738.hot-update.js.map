{"version":3,"file":"static/webpack/static\\development\\pages\\login.js.1395eb07b1a4ef84e738.hot-update.js","sources":["webpack:///./pages/login.js"],"sourcesContent":["import { Component } from \"react\";\r\nimport fetch from \"isomorphic-unfetch\";\r\nimport Layout from \"../components/layout\";\r\nimport { login } from \"../api/login\";\r\nimport { Cookies } from 'react-cookie';\r\n\r\nconst cookies = new Cookies();\r\nclass Login extends Component {\r\n  static getInitialProps () {\r\n      \r\n\r\n    const apiUrl = 'http://localhost:8080/auth/login'\r\n\r\n    return { apiUrl }\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const {  send } = require('micro')\r\n\r\n    this.state = { correo: \"\", clave:\"\", error: \"\",   token: cookies.get('token') || null };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.handleChangePassword = this.handleChangePassword.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.setState({ correo: event.target.value });\r\n  }\r\n  \r\nhandleChangePassword(event)\r\n{\r\n  this.setState({ clave: event.target.value });\r\n}\r\n\r\n  async handleSubmit(event) {\r\n    event.preventDefault();\r\n   \r\n    try {\r\n      const _correo = this.state.correo;\r\n      const _clave = this.state.clave;\r\n      const url = this.props.apiUrl;\r\n     const body = { correo: _correo,clave: _clave };\r\n      const response = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: { \r\n        'Content-Type': 'application/json' },\r\n        body: JSON.stringify(body),\r\n      });\r\n\r\n      const data = await response.json();\r\n    \r\n      console.log(\"Hillipoyas\" + JSON.stringify(data));\r\n    //console.log(\"status\"+data.status)\r\n      if (data.status === 200) {\r\n        const token = data.access_token;\r\n       cookies.set('token', token);\r\n       this.setState({\r\n         token: token\r\n       })\r\n       console.log(\"Login succesfully\")       \r\n\r\n     //   const { access_token } = await response.json();\r\n     //   login({ access_token });\r\n      } else {\r\n        console.log(\"Login failed.\");\r\n        \r\n        // https://github.com/developit/unfetch#caveats\r\n        let error = new Error(data.message);\r\n        error.data = data;\r\n        this.setState({ \r\n          error: data.message\r\n        })\r\n      //  return Promise.reject(error);\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        \"You have an error in your code or there are Network issues.\",\r\n        error\r\n      );\r\n     \r\n      throw new Error(error);\r\n\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Layout>\r\n        <h3>Ingrese con su usuario y contrasena : </h3>\r\n        <div className=\"login\">\r\n          <form onSubmit={this.handleSubmit}>\r\n            <label htmlFor=\"correo\">username</label>\r\n\r\n            <input\r\n              type=\"text\"\r\n              id=\"correo\"\r\n              name=\"correo\"\r\n              value={this.state.correo}\r\n              onChange={this.handleChange}\r\n            />\r\n             <label htmlFor=\"clave\">password</label>\r\n               <input\r\n              type=\"text\"\r\n              id=\"clave\"\r\n              name=\"clave\"\r\n              value={this.state.clave}\r\n              onChange={this.handleChangePassword}\r\n            />\r\n\r\n            <button type=\"submit\">Login</button>\r\n\r\n            <p className={`token ${!this.state.token && \"show\"}`}>\r\n              {this.state.token && `Token: ${this.state.token}`}\r\n            </p>\r\n             \r\n            <p className={`error ${this.state.error && \"show\"}`}>\r\n              {this.state.error && `Error: ${this.state.error}`}\r\n            </p>\r\n          </form>\r\n        </div>\r\n        <style jsx>{`\r\n          .login {\r\n            max-width: 340px;\r\n            margin: 0 auto;\r\n            padding: 1rem;\r\n            border: 1px solid #ccc;\r\n            border-radius: 4px;\r\n          }\r\n          form {\r\n            display: flex;\r\n            flex-flow: column;\r\n          }\r\n          label {\r\n            font-weight: 600;\r\n          }\r\n          input {\r\n            padding: 8px;\r\n            margin: 0.3rem 0 1rem;\r\n            border: 1px solid #ccc;\r\n            border-radius: 4px;\r\n          }\r\n          .error {\r\n            margin: 0.5rem 0 0;\r\n            display: none;\r\n            color: brown;\r\n          }\r\n          .error.show {\r\n            display: block;\r\n          }\r\n        `}</style>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;;;;;;;AACA;AAGA;AAEA;AAAA;AAAA;AACA;;;AAEA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAAA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAPA;AAQA;AACA;;;AACA;AACA;AAAA;AAAA;AACA;;;AAEA;AAEA;AAAA;AAAA;AACA;;;AAEA;;;;;;;AACA;;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;;AACA;AACA;AACA;AACA;AADA;AAEA;AAJA;AACA;;AADA;;AAOA;AACA;;AADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AAIA;AACA;;;;;;;AACA;AAKA;AACA;;;;;;;;;;AAIA;AACA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AALA;AAAA;AAOA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAQA;AAAA;AAAA;AAEA;AAAA;AAIA;AAAA;AA5BA;AAAA;AAiEA;;;;AAlJA;AACA;AAoJA;;;;A","sourceRoot":""}