{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { Component } from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport Layout from \"../components/layout\";\nimport { login } from \"../api/login\";\nimport { Cookies } from \"react-cookie\";\nimport Router from \"next/router\";\nconst cookies = new Cookies();\n\nclass Login extends Component {\n  static getInitialProps({\n    req\n  }) {\n    const protocol = false ? \"https\" : \"http\";\n    const apiUrl = \"http://localhost:8080/auth/login\";\n    return {\n      apiUrl\n    };\n  }\n\n  constructor(props) {\n    super(props);\n\n    const {\n      send\n    } = require(\"micro\");\n\n    this.state = {\n      correo: \"\",\n      clave: \"\",\n      error: \"\",\n      token: cookies.get(\"token\") || null\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleChangePassword = this.handleChangePassword.bind(this);\n  }\n\n  handleChange(event) {\n    this.setState({\n      correo: event.target.value\n    });\n  }\n\n  handleChangePassword(event) {\n    this.setState({\n      clave: event.target.value\n    });\n  }\n\n  async handleSubmit(event) {\n    event.preventDefault();\n\n    try {\n      const _correo = this.state.correo;\n      const _clave = this.state.clave;\n      const url = this.props.apiUrl;\n      const body = {\n        correo: _correo,\n        clave: _clave\n      };\n      const response = await fetch(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(body)\n      });\n      const data = await response.json();\n      console.log(\"Hillipoyas\" + JSON.stringify(data)); //console.log(\"status\"+data.status)\n\n      if (data.status === 200) {\n        const token = data.access_token;\n        cookies.set(\"token\", token);\n        this.setState({\n          token: token\n        });\n        console.log(\"Login succesfully\");\n        Router.push(\"/\"); //   const { access_token } = await response.json();\n        //   login({ access_token });\n      } else {\n        console.log(\"Login failed.\"); // https://github.com/developit/unfetch#caveats\n\n        let error = new Error(data.message);\n        error.data = data;\n        this.setState({\n          error: data.message\n        }); //  return Promise.reject(error);\n      }\n    } catch (error) {\n      console.error(\"You have an error in your code or there are Network issues.\", error);\n      throw new Error(error);\n    }\n  }\n\n  render() {\n    return __jsx(Layout, null, __jsx(\"div\", {\n      className: \"jsx-923656326\" + \" \" + \"login\"\n    }, __jsx(\"form\", {\n      onSubmit: this.handleSubmit,\n      className: \"jsx-923656326\"\n    }, __jsx(\"label\", {\n      htmlFor: \"correo\",\n      className: \"jsx-923656326\"\n    }, \"username\"), __jsx(\"input\", {\n      type: \"text\",\n      id: \"correo\",\n      name: \"correo\",\n      value: this.state.correo,\n      onChange: this.handleChange,\n      className: \"jsx-923656326\"\n    }), __jsx(\"label\", {\n      htmlFor: \"clave\",\n      className: \"jsx-923656326\"\n    }, \"password\"), __jsx(\"input\", {\n      type: \"text\",\n      id: \"clave\",\n      name: \"clave\",\n      value: this.state.clave,\n      onChange: this.handleChangePassword,\n      className: \"jsx-923656326\"\n    }), __jsx(\"button\", {\n      type: \"submit\",\n      className: \"jsx-923656326\"\n    }, \"Login\"), __jsx(\"p\", {\n      className: \"jsx-923656326\" + \" \" + `token ${!this.state.token && \"show\"}`\n    }, this.state.token && `Token: ${this.state.token}`), __jsx(\"p\", {\n      className: \"jsx-923656326\" + \" \" + `error ${this.state.error && \"show\"}`\n    }, this.state.error && `Error: ${this.state.error}`))), __jsx(_JSXStyle, {\n      id: \"923656326\"\n    }, \".login.jsx-923656326{max-width:340px;margin:0 auto;padding:1rem;border:1px solid #ccc;border-radius:4px;}form.jsx-923656326{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:column;-ms-flex-flow:column;flex-flow:column;}label.jsx-923656326{font-weight:600;}input.jsx-923656326{padding:8px;margin:0.3rem 0 1rem;border:1px solid #ccc;border-radius:4px;}.error.jsx-923656326{margin:0.5rem 0 0;display:none;color:brown;}.error.show.jsx-923656326{display:block;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcU2ViYXN0aWFuXFxEZXNrdG9wXFxpbmNhc2V3ZWJcXHBhZ2VzXFxsb2dpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUE2SG9CLEFBRzZCLEFBT0gsQUFJRyxBQUdKLEFBTU0sQUFLSixZQVZPLEVBV3ZCLEVBekJnQixBQVdoQixFQVNlLFlBbkJBLENBb0JELEVBTlUsVUFiQSxBQW9CeEIsWUFOb0IsVUFiQSxRQWNwQixDQVZtQixTQUhuQixzREFJQSIsImZpbGUiOiJDOlxcVXNlcnNcXFNlYmFzdGlhblxcRGVza3RvcFxcaW5jYXNld2ViXFxwYWdlc1xcbG9naW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IGZldGNoIGZyb20gXCJpc29tb3JwaGljLXVuZmV0Y2hcIjtcclxuaW1wb3J0IExheW91dCBmcm9tIFwiLi4vY29tcG9uZW50cy9sYXlvdXRcIjtcclxuaW1wb3J0IHsgbG9naW4gfSBmcm9tIFwiLi4vYXBpL2xvZ2luXCI7XHJcbmltcG9ydCB7IENvb2tpZXMgfSBmcm9tIFwicmVhY3QtY29va2llXCI7XHJcbmltcG9ydCBSb3V0ZXIgZnJvbSBcIm5leHQvcm91dGVyXCI7XHJcblxyXG5jb25zdCBjb29raWVzID0gbmV3IENvb2tpZXMoKTtcclxuY2xhc3MgTG9naW4gZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gIHN0YXRpYyBnZXRJbml0aWFsUHJvcHMoeyByZXEgfSkge1xyXG4gICAgY29uc3QgcHJvdG9jb2wgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIgPyBcImh0dHBzXCIgOiBcImh0dHBcIjtcclxuXHJcbiAgICBjb25zdCBhcGlVcmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hdXRoL2xvZ2luXCI7XHJcblxyXG4gICAgcmV0dXJuIHsgYXBpVXJsIH07XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgY29uc3QgeyBzZW5kIH0gPSByZXF1aXJlKFwibWljcm9cIik7XHJcblxyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgY29ycmVvOiBcIlwiLFxyXG4gICAgICBjbGF2ZTogXCJcIixcclxuICAgICAgZXJyb3I6IFwiXCIsXHJcbiAgICAgIHRva2VuOiBjb29raWVzLmdldChcInRva2VuXCIpIHx8IG51bGwsXHJcbiAgICB9O1xyXG4gICAgdGhpcy5oYW5kbGVDaGFuZ2UgPSB0aGlzLmhhbmRsZUNoYW5nZS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5oYW5kbGVTdWJtaXQgPSB0aGlzLmhhbmRsZVN1Ym1pdC5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5oYW5kbGVDaGFuZ2VQYXNzd29yZCA9IHRoaXMuaGFuZGxlQ2hhbmdlUGFzc3dvcmQuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIGhhbmRsZUNoYW5nZShldmVudCkge1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGNvcnJlbzogZXZlbnQudGFyZ2V0LnZhbHVlIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlQ2hhbmdlUGFzc3dvcmQoZXZlbnQpIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoeyBjbGF2ZTogZXZlbnQudGFyZ2V0LnZhbHVlIH0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgaGFuZGxlU3VibWl0KGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IF9jb3JyZW8gPSB0aGlzLnN0YXRlLmNvcnJlbztcclxuICAgICAgY29uc3QgX2NsYXZlID0gdGhpcy5zdGF0ZS5jbGF2ZTtcclxuICAgICAgY29uc3QgdXJsID0gdGhpcy5wcm9wcy5hcGlVcmw7XHJcbiAgICAgIGNvbnN0IGJvZHkgPSB7IGNvcnJlbzogX2NvcnJlbywgY2xhdmU6IF9jbGF2ZSB9O1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coXCJIaWxsaXBveWFzXCIgKyBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgIC8vY29uc29sZS5sb2coXCJzdGF0dXNcIitkYXRhLnN0YXR1cylcclxuICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICBjb25zdCB0b2tlbiA9IGRhdGEuYWNjZXNzX3Rva2VuO1xyXG4gICAgICAgIGNvb2tpZXMuc2V0KFwidG9rZW5cIiwgdG9rZW4pO1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgdG9rZW46IHRva2VuLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiTG9naW4gc3VjY2VzZnVsbHlcIik7XHJcbiAgICAgICAgUm91dGVyLnB1c2goXCIvXCIpO1xyXG4gICAgICAgIC8vICAgY29uc3QgeyBhY2Nlc3NfdG9rZW4gfSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICAvLyAgIGxvZ2luKHsgYWNjZXNzX3Rva2VuIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiTG9naW4gZmFpbGVkLlwiKTtcclxuXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2RldmVsb3BpdC91bmZldGNoI2NhdmVhdHNcclxuICAgICAgICBsZXQgZXJyb3IgPSBuZXcgRXJyb3IoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICBlcnJvci5kYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgIGVycm9yOiBkYXRhLm1lc3NhZ2UsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXHJcbiAgICAgICAgXCJZb3UgaGF2ZSBhbiBlcnJvciBpbiB5b3VyIGNvZGUgb3IgdGhlcmUgYXJlIE5ldHdvcmsgaXNzdWVzLlwiLFxyXG4gICAgICAgIGVycm9yXHJcbiAgICAgICk7XHJcblxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPExheW91dD5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxvZ2luXCI+XHJcbiAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17dGhpcy5oYW5kbGVTdWJtaXR9PlxyXG4gICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj1cImNvcnJlb1wiPnVzZXJuYW1lPC9sYWJlbD5cclxuXHJcbiAgICAgICAgICAgIDxpbnB1dFxyXG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgICBpZD1cImNvcnJlb1wiXHJcbiAgICAgICAgICAgICAgbmFtZT1cImNvcnJlb1wiXHJcbiAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUuY29ycmVvfVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZUNoYW5nZX1cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJjbGF2ZVwiPnBhc3N3b3JkPC9sYWJlbD5cclxuICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICAgIGlkPVwiY2xhdmVcIlxyXG4gICAgICAgICAgICAgIG5hbWU9XCJjbGF2ZVwiXHJcbiAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUuY2xhdmV9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlQ2hhbmdlUGFzc3dvcmR9XHJcbiAgICAgICAgICAgIC8+XHJcblxyXG4gICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJzdWJtaXRcIj5Mb2dpbjwvYnV0dG9uPlxyXG5cclxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPXtgdG9rZW4gJHshdGhpcy5zdGF0ZS50b2tlbiAmJiBcInNob3dcIn1gfT5cclxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS50b2tlbiAmJiBgVG9rZW46ICR7dGhpcy5zdGF0ZS50b2tlbn1gfVxyXG4gICAgICAgICAgICA8L3A+XHJcblxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9e2BlcnJvciAke3RoaXMuc3RhdGUuZXJyb3IgJiYgXCJzaG93XCJ9YH0+XHJcbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuZXJyb3IgJiYgYEVycm9yOiAke3RoaXMuc3RhdGUuZXJyb3J9YH1cclxuICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgPC9mb3JtPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxzdHlsZSBqc3g+e2BcclxuICAgICAgICAgIC5sb2dpbiB7XHJcbiAgICAgICAgICAgIG1heC13aWR0aDogMzQwcHg7XHJcbiAgICAgICAgICAgIG1hcmdpbjogMCBhdXRvO1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAxcmVtO1xyXG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmb3JtIHtcclxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgICAgZmxleC1mbG93OiBjb2x1bW47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBsYWJlbCB7XHJcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpbnB1dCB7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDhweDtcclxuICAgICAgICAgICAgbWFyZ2luOiAwLjNyZW0gMCAxcmVtO1xyXG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAuZXJyb3Ige1xyXG4gICAgICAgICAgICBtYXJnaW46IDAuNXJlbSAwIDA7XHJcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICAgICAgICAgIGNvbG9yOiBicm93bjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5lcnJvci5zaG93IHtcclxuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgYH08L3N0eWxlPlxyXG4gICAgICA8L0xheW91dD5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBMb2dpbjtcclxuIl19 */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\Sebastian\\\\\\\\Desktop\\\\\\\\incaseweb\\\\\\\\pages\\\\\\\\login.js */\"));\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["C:/Users/Sebastian/Desktop/incaseweb/pages/login.js"],"names":["Component","fetch","Layout","login","Cookies","Router","cookies","Login","getInitialProps","req","protocol","apiUrl","constructor","props","send","require","state","correo","clave","error","token","get","handleChange","bind","handleSubmit","handleChangePassword","event","setState","target","value","preventDefault","_correo","_clave","url","body","response","method","headers","JSON","stringify","data","json","console","log","status","access_token","set","push","Error","message","render"],"mappings":"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","sourcesContent":["import { Component } from \"react\";\r\nimport fetch from \"isomorphic-unfetch\";\r\nimport Layout from \"../components/layout\";\r\nimport { login } from \"../api/login\";\r\nimport { Cookies } from \"react-cookie\";\r\nimport Router from \"next/router\";\r\n\r\nconst cookies = new Cookies();\r\nclass Login extends Component {\r\n  static getInitialProps({ req }) {\r\n    const protocol = process.env.NODE_ENV === \"production\" ? \"https\" : \"http\";\r\n\r\n    const apiUrl = \"http://localhost:8080/auth/login\";\r\n\r\n    return { apiUrl };\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const { send } = require(\"micro\");\r\n\r\n    this.state = {\r\n      correo: \"\",\r\n      clave: \"\",\r\n      error: \"\",\r\n      token: cookies.get(\"token\") || null,\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.handleChangePassword = this.handleChangePassword.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.setState({ correo: event.target.value });\r\n  }\r\n\r\n  handleChangePassword(event) {\r\n    this.setState({ clave: event.target.value });\r\n  }\r\n\r\n  async handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    try {\r\n      const _correo = this.state.correo;\r\n      const _clave = this.state.clave;\r\n      const url = this.props.apiUrl;\r\n      const body = { correo: _correo, clave: _clave };\r\n      const response = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(body),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      console.log(\"Hillipoyas\" + JSON.stringify(data));\r\n      //console.log(\"status\"+data.status)\r\n      if (data.status === 200) {\r\n        const token = data.access_token;\r\n        cookies.set(\"token\", token);\r\n        this.setState({\r\n          token: token,\r\n        });\r\n        console.log(\"Login succesfully\");\r\n        Router.push(\"/\");\r\n        //   const { access_token } = await response.json();\r\n        //   login({ access_token });\r\n      } else {\r\n        console.log(\"Login failed.\");\r\n\r\n        // https://github.com/developit/unfetch#caveats\r\n        let error = new Error(data.message);\r\n        error.data = data;\r\n        this.setState({\r\n          error: data.message,\r\n        });\r\n        //  return Promise.reject(error);\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        \"You have an error in your code or there are Network issues.\",\r\n        error\r\n      );\r\n\r\n      throw new Error(error);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Layout>\r\n        <div className=\"login\">\r\n          <form onSubmit={this.handleSubmit}>\r\n            <label htmlFor=\"correo\">username</label>\r\n\r\n            <input\r\n              type=\"text\"\r\n              id=\"correo\"\r\n              name=\"correo\"\r\n              value={this.state.correo}\r\n              onChange={this.handleChange}\r\n            />\r\n            <label htmlFor=\"clave\">password</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"clave\"\r\n              name=\"clave\"\r\n              value={this.state.clave}\r\n              onChange={this.handleChangePassword}\r\n            />\r\n\r\n            <button type=\"submit\">Login</button>\r\n\r\n            <p className={`token ${!this.state.token && \"show\"}`}>\r\n              {this.state.token && `Token: ${this.state.token}`}\r\n            </p>\r\n\r\n            <p className={`error ${this.state.error && \"show\"}`}>\r\n              {this.state.error && `Error: ${this.state.error}`}\r\n            </p>\r\n          </form>\r\n        </div>\r\n        <style jsx>{`\r\n          .login {\r\n            max-width: 340px;\r\n            margin: 0 auto;\r\n            padding: 1rem;\r\n            border: 1px solid #ccc;\r\n            border-radius: 4px;\r\n          }\r\n          form {\r\n            display: flex;\r\n            flex-flow: column;\r\n          }\r\n          label {\r\n            font-weight: 600;\r\n          }\r\n          input {\r\n            padding: 8px;\r\n            margin: 0.3rem 0 1rem;\r\n            border: 1px solid #ccc;\r\n            border-radius: 4px;\r\n          }\r\n          .error {\r\n            margin: 0.5rem 0 0;\r\n            display: none;\r\n            color: brown;\r\n          }\r\n          .error.show {\r\n            display: block;\r\n          }\r\n        `}</style>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}