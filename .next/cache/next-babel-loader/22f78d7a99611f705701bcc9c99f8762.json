{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport Head from \"next/head\";\nimport Header from \"../components/Header\";\nimport { Component } from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport Layout from \"../components/layout\";\nimport { login } from \"../api/login\";\nimport { Cookies } from \"react-cookie\";\nimport Router from \"next/router\";\nimport { connect } from \"react-redux\";\nimport Button from \"@material-ui/core/Button\";\nimport { green, purple } from '@material-ui/core/colors';\nvar appTitle = \"> WHATABYTE\";\nvar cookies = new Cookies();\n\nvar Login = /*#__PURE__*/function (_Component) {\n  _inherits(Login, _Component);\n\n  var _super = _createSuper(Login);\n\n  _createClass(Login, null, [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(_ref) {\n      var store = _ref.store,\n          req = _ref.req;\n      console.log(\"la store:\" + store);\n      var apiUrl = \"http://localhost:8080/auth/login\";\n      return {\n        apiUrl: apiUrl\n      };\n    }\n  }]);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _super.call(this, props);\n\n    var _require = require(\"micro\"),\n        send = _require.send;\n\n    _this.state = {\n      correo: \"\",\n      clave: \"\",\n      error: \"\",\n      token: cookies.get(\"token\") || null\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_this));\n    _this.handleChangePassword = _this.handleChangePassword.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      this.setState({\n        correo: event.target.value\n      });\n    }\n  }, {\n    key: \"handleChangePassword\",\n    value: function handleChangePassword(event) {\n      this.setState({\n        clave: event.target.value\n      });\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(event) {\n      var _correo, _clave, url, body, response, data, token, action, error;\n\n      return _regeneratorRuntime.async(function handleSubmit$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              _context.prev = 1;\n              _correo = this.state.correo;\n              _clave = this.state.clave;\n              url = this.props.apiUrl;\n              body = {\n                correo: _correo,\n                clave: _clave\n              };\n              _context.next = 8;\n              return _regeneratorRuntime.awrap(fetch(url, {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(body)\n              }));\n\n            case 8:\n              response = _context.sent;\n              _context.next = 11;\n              return _regeneratorRuntime.awrap(response.json());\n\n            case 11:\n              data = _context.sent;\n              console.log(\"Hillipoyas\" + JSON.stringify(data)); //console.log(\"status\"+data.status)\n\n              if (data.status === 200) {\n                token = data.access_token;\n                cookies.set(\"token\", token);\n                action = {\n                  type: 'ADD_USER_ID',\n                  payload: data.user_id\n                };\n                this.props.dispatch(action);\n                console.log(\"Login succesfully\");\n                Router.push(\"/\"); //   const { access_token } = await response.json();\n                //   login({ access_token });\n              } else {\n                console.log(\"Login failed.\"); // https://github.com/developit/unfetch#caveats\n\n                error = new Error(data.message);\n                error.data = data;\n                this.setState({\n                  error: data.message\n                }); //  return Promise.reject(error);\n              }\n\n              _context.next = 20;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](1);\n              console.error(\"You have an error in your code or there are Network issues.\", _context.t0);\n              throw new Error(_context.t0);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, [[1, 16]], Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      console.log(\"login\" + JSON.stringify(this.props));\n      return __jsx(\"div\", {\n        className: \"jsx-923656326\" + \" \" + \"Layout\"\n      }, __jsx(Head, null, __jsx(\"title\", {\n        className: \"jsx-923656326\"\n      }, \"WHATABYTE\"), __jsx(\"meta\", {\n        name: \"viewport\",\n        content: \"width=device-width, initial-scale=1\",\n        className: \"jsx-923656326\"\n      }), __jsx(\"meta\", {\n        charSet: \"utf-8\",\n        className: \"jsx-923656326\"\n      })), __jsx(Header, {\n        appTitle: appTitle\n      }), __jsx(\"div\", {\n        className: \"jsx-923656326\" + \" \" + \"Content\"\n      }, __jsx(\"div\", {\n        className: \"jsx-923656326\"\n      }, __jsx(\"h3\", {\n        className: \"jsx-923656326\"\n      }, \"Bienvenido a \", appTitle, \" , Porfavor digite su usuario y contrasena :  \")), __jsx(\"div\", {\n        className: \"jsx-923656326\" + \" \" + \"login\"\n      }, __jsx(\"form\", {\n        className: \"jsx-923656326\"\n      }, __jsx(\"label\", {\n        htmlFor: \"correo\",\n        className: \"jsx-923656326\"\n      }, \"username\"), __jsx(\"input\", {\n        type: \"text\",\n        id: \"correo\",\n        name: \"correo\",\n        value: this.state.correo,\n        onChange: this.handleChange,\n        className: \"jsx-923656326\"\n      }), __jsx(\"label\", {\n        htmlFor: \"clave\",\n        className: \"jsx-923656326\"\n      }, \"password\"), __jsx(\"input\", {\n        type: \"text\",\n        id: \"clave\",\n        name: \"clave\",\n        value: this.state.clave,\n        onChange: this.handleChangePassword,\n        className: \"jsx-923656326\"\n      }), __jsx(Button, {\n        variant: \"contained\",\n        color: green,\n        onClick: this.handleSubmit\n      }, \"Iniciar Sesion\"), __jsx(\"p\", {\n        className: \"jsx-923656326\" + \" \" + \"token \".concat(!this.state.token && \"show\")\n      }, this.state.token && \"Token: \".concat(this.state.token)), __jsx(\"p\", {\n        className: \"jsx-923656326\" + \" \" + \"error \".concat(this.state.error && \"show\")\n      }, this.state.error && \"Error: \".concat(this.state.error))))), __jsx(_JSXStyle, {\n        id: \"923656326\"\n      }, \".login.jsx-923656326{max-width:340px;margin:0 auto;padding:1rem;border:1px solid #ccc;border-radius:4px;}form.jsx-923656326{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:column;-ms-flex-flow:column;flex-flow:column;}label.jsx-923656326{font-weight:600;}input.jsx-923656326{padding:8px;margin:0.3rem 0 1rem;border:1px solid #ccc;border-radius:4px;}.error.jsx-923656326{margin:0.5rem 0 0;display:none;color:brown;}.error.show.jsx-923656326{display:block;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcUmlhbm9cXERvY3VtZW50c1xcZ29jYXJcXGluY2FzZXdlYlxccGFnZXNcXGxvZ2luLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQW9Kb0IsQUFHNkIsQUFPSCxBQUlHLEFBR0osQUFNTSxBQUtKLFlBVk8sRUFXdkIsRUF6QmdCLEFBV2hCLEVBU2UsWUFuQkEsQ0FvQkQsRUFOVSxVQWJBLEFBb0J4QixZQU5vQixVQWJBLFFBY3BCLENBVm1CLFNBSG5CLHNEQUlBIiwiZmlsZSI6IkM6XFxVc2Vyc1xcUmlhbm9cXERvY3VtZW50c1xcZ29jYXJcXGluY2FzZXdlYlxccGFnZXNcXGxvZ2luLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEhlYWQgZnJvbSBcIm5leHQvaGVhZFwiO1xyXG5pbXBvcnQgSGVhZGVyIGZyb20gXCIuLi9jb21wb25lbnRzL0hlYWRlclwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IGZldGNoIGZyb20gXCJpc29tb3JwaGljLXVuZmV0Y2hcIjtcclxuaW1wb3J0IExheW91dCBmcm9tIFwiLi4vY29tcG9uZW50cy9sYXlvdXRcIjtcclxuaW1wb3J0IHsgbG9naW4gfSBmcm9tIFwiLi4vYXBpL2xvZ2luXCI7XHJcbmltcG9ydCB7IENvb2tpZXMgfSBmcm9tIFwicmVhY3QtY29va2llXCI7XHJcbmltcG9ydCBSb3V0ZXIgZnJvbSBcIm5leHQvcm91dGVyXCI7XHJcbmltcG9ydCB7Y29ubmVjdH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XHJcbmltcG9ydCBCdXR0b24gZnJvbSBcIkBtYXRlcmlhbC11aS9jb3JlL0J1dHRvblwiO1xyXG5pbXBvcnQgeyBncmVlbiwgcHVycGxlIH0gZnJvbSAnQG1hdGVyaWFsLXVpL2NvcmUvY29sb3JzJztcclxuY29uc3QgYXBwVGl0bGUgPSBgPiBXSEFUQUJZVEVgO1xyXG5jb25zdCBjb29raWVzID0gbmV3IENvb2tpZXMoKTtcclxuY2xhc3MgTG9naW4gZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gIHN0YXRpYyBnZXRJbml0aWFsUHJvcHMoeyBzdG9yZSxyZXEgfSkge1xyXG4gICAgY29uc29sZS5sb2coXCJsYSBzdG9yZTpcIitzdG9yZSlcclxuXHJcbiAgICBjb25zdCBhcGlVcmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hdXRoL2xvZ2luXCI7XHJcblxyXG4gICAgcmV0dXJuIHsgYXBpVXJsIH07XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgY29uc3QgeyBzZW5kIH0gPSByZXF1aXJlKFwibWljcm9cIik7XHJcblxyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgY29ycmVvOiBcIlwiLFxyXG4gICAgICBjbGF2ZTogXCJcIixcclxuICAgICAgZXJyb3I6IFwiXCIsXHJcbiAgICAgIHRva2VuOiBjb29raWVzLmdldChcInRva2VuXCIpIHx8IG51bGwsXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB0aGlzLmhhbmRsZUNoYW5nZSA9IHRoaXMuaGFuZGxlQ2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IHRoaXMuaGFuZGxlU3VibWl0LmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmhhbmRsZUNoYW5nZVBhc3N3b3JkID0gdGhpcy5oYW5kbGVDaGFuZ2VQYXNzd29yZC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICB0aGlzLnNldFN0YXRlKHsgY29ycmVvOiBldmVudC50YXJnZXQudmFsdWUgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVDaGFuZ2VQYXNzd29yZChldmVudCkge1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGNsYXZlOiBldmVudC50YXJnZXQudmFsdWUgfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBoYW5kbGVTdWJtaXQoZXZlbnQpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgX2NvcnJlbyA9IHRoaXMuc3RhdGUuY29ycmVvO1xyXG4gICAgICBjb25zdCBfY2xhdmUgPSB0aGlzLnN0YXRlLmNsYXZlO1xyXG4gICAgICBjb25zdCB1cmwgPSB0aGlzLnByb3BzLmFwaVVybDtcclxuICAgICAgY29uc3QgYm9keSA9IHsgY29ycmVvOiBfY29ycmVvLCBjbGF2ZTogX2NsYXZlIH07XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIkhpbGxpcG95YXNcIiArIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgLy9jb25zb2xlLmxvZyhcInN0YXR1c1wiK2RhdGEuc3RhdHVzKVxyXG4gICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgIGNvbnN0IHRva2VuID0gZGF0YS5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgY29va2llcy5zZXQoXCJ0b2tlblwiLCB0b2tlbik7XHJcbiAgICAgICAgY29uc3QgYWN0aW9uID0geyB0eXBlOiAnQUREX1VTRVJfSUQnICxwYXlsb2FkOiBkYXRhLnVzZXJfaWQgfVxyXG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goYWN0aW9uKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkxvZ2luIHN1Y2Nlc2Z1bGx5XCIpO1xyXG4gICAgICAgIFJvdXRlci5wdXNoKFwiL1wiKTtcclxuICAgICAgICAvLyAgIGNvbnN0IHsgYWNjZXNzX3Rva2VuIH0gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgLy8gICBsb2dpbih7IGFjY2Vzc190b2tlbiB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkxvZ2luIGZhaWxlZC5cIik7XHJcblxyXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kZXZlbG9waXQvdW5mZXRjaCNjYXZlYXRzXHJcbiAgICAgICAgbGV0IGVycm9yID0gbmV3IEVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgZXJyb3IuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICBlcnJvcjogZGF0YS5tZXNzYWdlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFxyXG4gICAgICAgIFwiWW91IGhhdmUgYW4gZXJyb3IgaW4geW91ciBjb2RlIG9yIHRoZXJlIGFyZSBOZXR3b3JrIGlzc3Vlcy5cIixcclxuICAgICAgICBlcnJvclxyXG4gICAgICApO1xyXG5cclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnNvbGUubG9nKFwibG9naW5cIiArIEpTT04uc3RyaW5naWZ5KHRoaXMucHJvcHMpKVxyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJMYXlvdXRcIj5cclxuICAgICAgICA8SGVhZD5cclxuICAgICAgICAgIDx0aXRsZT5XSEFUQUJZVEU8L3RpdGxlPlxyXG4gICAgICAgICAgPG1ldGEgbmFtZT1cInZpZXdwb3J0XCIgY29udGVudD1cIndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xXCIgLz5cclxuICAgICAgICAgIDxtZXRhIGNoYXJTZXQ9XCJ1dGYtOFwiIC8+XHJcbiAgICAgICAgPC9IZWFkPlxyXG5cclxuICAgICAgICA8SGVhZGVyIGFwcFRpdGxlPXthcHBUaXRsZX0gLz5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIkNvbnRlbnRcIj5cclxuICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICA8aDM+QmllbnZlbmlkbyBhIHthcHBUaXRsZX0gLCBQb3JmYXZvciBkaWdpdGUgc3UgdXN1YXJpbyB5IGNvbnRyYXNlbmEgOiAgPC9oMz5cclxuXHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgIFxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsb2dpblwiPlxyXG4gICAgICAgICAgICA8Zm9ybT5cclxuICAgICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj1cImNvcnJlb1wiPnVzZXJuYW1lPC9sYWJlbD5cclxuXHJcbiAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgICBpZD1cImNvcnJlb1wiXHJcbiAgICAgICAgICAgICAgICBuYW1lPVwiY29ycmVvXCJcclxuICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmNvcnJlb31cclxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZUNoYW5nZX1cclxuICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiY2xhdmVcIj5wYXNzd29yZDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgICBpZD1cImNsYXZlXCJcclxuICAgICAgICAgICAgICAgIG5hbWU9XCJjbGF2ZVwiXHJcbiAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5jbGF2ZX1cclxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZUNoYW5nZVBhc3N3b3JkfVxyXG4gICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwiY29udGFpbmVkXCIgY29sb3I9e2dyZWVufSBvbkNsaWNrPXt0aGlzLmhhbmRsZVN1Ym1pdH0+XHJcbiAgSW5pY2lhciBTZXNpb25cclxuPC9CdXR0b24+XHJcblxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT17YHRva2VuICR7IXRoaXMuc3RhdGUudG9rZW4gJiYgXCJzaG93XCJ9YH0+XHJcbiAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS50b2tlbiAmJiBgVG9rZW46ICR7dGhpcy5zdGF0ZS50b2tlbn1gfVxyXG4gICAgICAgICAgICAgIDwvcD5cclxuXHJcbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPXtgZXJyb3IgJHt0aGlzLnN0YXRlLmVycm9yICYmIFwic2hvd1wifWB9PlxyXG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuZXJyb3IgJiYgYEVycm9yOiAke3RoaXMuc3RhdGUuZXJyb3J9YH1cclxuICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgIDwvZm9ybT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxzdHlsZSBqc3g+e2BcclxuICAgICAgICAgIC5sb2dpbiB7XHJcbiAgICAgICAgICAgIG1heC13aWR0aDogMzQwcHg7XHJcbiAgICAgICAgICAgIG1hcmdpbjogMCBhdXRvO1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAxcmVtO1xyXG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmb3JtIHtcclxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgICAgZmxleC1mbG93OiBjb2x1bW47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBsYWJlbCB7XHJcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpbnB1dCB7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDhweDtcclxuICAgICAgICAgICAgbWFyZ2luOiAwLjNyZW0gMCAxcmVtO1xyXG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAuZXJyb3Ige1xyXG4gICAgICAgICAgICBtYXJnaW46IDAuNXJlbSAwIDA7XHJcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICAgICAgICAgIGNvbG9yOiBicm93bjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5lcnJvci5zaG93IHtcclxuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgYH08L3N0eWxlPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCAgY29ubmVjdChcclxuICAoc3RhdGUpID0+IHN0YXRlLFxyXG4gXHJcbikoTG9naW4pO1xyXG4iXX0= */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\Riano\\\\\\\\Documents\\\\\\\\gocar\\\\\\\\incaseweb\\\\\\\\pages\\\\\\\\login.js */\"));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport default connect(function (state) {\n  return state;\n})(Login);","map":{"version":3,"sources":["C:/Users/Riano/Documents/gocar/incaseweb/pages/login.js"],"names":["Head","Header","Component","fetch","Layout","login","Cookies","Router","connect","Button","green","purple","appTitle","cookies","Login","store","req","console","log","apiUrl","props","require","send","state","correo","clave","error","token","get","handleChange","bind","handleSubmit","handleChangePassword","event","setState","target","value","preventDefault","_correo","_clave","url","body","method","headers","JSON","stringify","response","json","data","status","access_token","set","action","type","payload","user_id","dispatch","push","Error","message"],"mappings":"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","sourcesContent":["import Head from \"next/head\";\r\nimport Header from \"../components/Header\";\r\nimport { Component } from \"react\";\r\nimport fetch from \"isomorphic-unfetch\";\r\nimport Layout from \"../components/layout\";\r\nimport { login } from \"../api/login\";\r\nimport { Cookies } from \"react-cookie\";\r\nimport Router from \"next/router\";\r\nimport {connect} from \"react-redux\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { green, purple } from '@material-ui/core/colors';\r\nconst appTitle = `> WHATABYTE`;\r\nconst cookies = new Cookies();\r\nclass Login extends Component {\r\n  static getInitialProps({ store,req }) {\r\n    console.log(\"la store:\"+store)\r\n\r\n    const apiUrl = \"http://localhost:8080/auth/login\";\r\n\r\n    return { apiUrl };\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const { send } = require(\"micro\");\r\n\r\n    this.state = {\r\n      correo: \"\",\r\n      clave: \"\",\r\n      error: \"\",\r\n      token: cookies.get(\"token\") || null,\r\n    };\r\n    \r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.handleChangePassword = this.handleChangePassword.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.setState({ correo: event.target.value });\r\n  }\r\n\r\n  handleChangePassword(event) {\r\n    this.setState({ clave: event.target.value });\r\n  }\r\n\r\n  async handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    try {\r\n      const _correo = this.state.correo;\r\n      const _clave = this.state.clave;\r\n      const url = this.props.apiUrl;\r\n      const body = { correo: _correo, clave: _clave };\r\n      const response = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(body),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      console.log(\"Hillipoyas\" + JSON.stringify(data));\r\n      //console.log(\"status\"+data.status)\r\n      if (data.status === 200) {\r\n        const token = data.access_token;\r\n        cookies.set(\"token\", token);\r\n        const action = { type: 'ADD_USER_ID' ,payload: data.user_id }\r\n        this.props.dispatch(action);\r\n        console.log(\"Login succesfully\");\r\n        Router.push(\"/\");\r\n        //   const { access_token } = await response.json();\r\n        //   login({ access_token });\r\n      } else {\r\n        console.log(\"Login failed.\");\r\n\r\n        // https://github.com/developit/unfetch#caveats\r\n        let error = new Error(data.message);\r\n        error.data = data;\r\n        this.setState({\r\n          error: data.message,\r\n        });\r\n        //  return Promise.reject(error);\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        \"You have an error in your code or there are Network issues.\",\r\n        error\r\n      );\r\n\r\n      throw new Error(error);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    console.log(\"login\" + JSON.stringify(this.props))\r\n    return (\r\n      <div className=\"Layout\">\r\n        <Head>\r\n          <title>WHATABYTE</title>\r\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n          <meta charSet=\"utf-8\" />\r\n        </Head>\r\n\r\n        <Header appTitle={appTitle} />\r\n        <div className=\"Content\">\r\n          <div>\r\n          <h3>Bienvenido a {appTitle} , Porfavor digite su usuario y contrasena :  </h3>\r\n\r\n           \r\n          </div>\r\n       \r\n          <div className=\"login\">\r\n            <form>\r\n              <label htmlFor=\"correo\">username</label>\r\n\r\n              <input\r\n                type=\"text\"\r\n                id=\"correo\"\r\n                name=\"correo\"\r\n                value={this.state.correo}\r\n                onChange={this.handleChange}\r\n              />\r\n              <label htmlFor=\"clave\">password</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"clave\"\r\n                name=\"clave\"\r\n                value={this.state.clave}\r\n                onChange={this.handleChangePassword}\r\n              />\r\n              \r\n              <Button variant=\"contained\" color={green} onClick={this.handleSubmit}>\r\n  Iniciar Sesion\r\n</Button>\r\n\r\n              <p className={`token ${!this.state.token && \"show\"}`}>\r\n                {this.state.token && `Token: ${this.state.token}`}\r\n              </p>\r\n\r\n              <p className={`error ${this.state.error && \"show\"}`}>\r\n                {this.state.error && `Error: ${this.state.error}`}\r\n              </p>\r\n            </form>\r\n          </div>\r\n        </div>\r\n        <style jsx>{`\r\n          .login {\r\n            max-width: 340px;\r\n            margin: 0 auto;\r\n            padding: 1rem;\r\n            border: 1px solid #ccc;\r\n            border-radius: 4px;\r\n          }\r\n          form {\r\n            display: flex;\r\n            flex-flow: column;\r\n          }\r\n          label {\r\n            font-weight: 600;\r\n          }\r\n          input {\r\n            padding: 8px;\r\n            margin: 0.3rem 0 1rem;\r\n            border: 1px solid #ccc;\r\n            border-radius: 4px;\r\n          }\r\n          .error {\r\n            margin: 0.5rem 0 0;\r\n            display: none;\r\n            color: brown;\r\n          }\r\n          .error.show {\r\n            display: block;\r\n          }\r\n        `}</style>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default  connect(\r\n  (state) => state,\r\n \r\n)(Login);\r\n"]},"metadata":{},"sourceType":"module"}